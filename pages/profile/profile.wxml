<!--pages/profile/profile.wxml-->
<view class="container">
  <!-- 用户信息区域 -->
  <view class="user-section">
    <view class="user-info">
      <image class="avatar" src="{{userInfo.avatar || '/images/default-avatar.png'}}" mode="aspectFill"></image>
      <view class="user-details">
        <text class="username">{{userInfo.nickname || '未设置昵称'}}</text>
        <text class="user-id">ID: {{userInfo.user_id || '000000'}}</text>
        <view class="member-badge" wx:if="{{memberLevel !== 'free'}}">
          <text class="badge-text">{{memberLevelText}}</text>
        </view>
      </view>
      <view class="edit-btn" bindtap="editProfile">
        <image src="/images/icon-edit.png" mode="aspectFit"></image>
      </view>
    </view>
    
    <!-- 会员信息 -->
    <view class="member-card" wx:if="{{memberLevel === 'free'}}">
      <view class="member-content">
        <view class="member-info">
          <text class="member-title">免费用户</text>
          <text class="member-desc">升级会员享受更多功能</text>
        </view>
        <button class="btn btn-primary btn-small" bindtap="upgradeMember">立即升级</button>
      </view>
    </view>
    
    <view class="member-card premium" wx:else>
      <view class="member-content">
        <view class="member-info">
          <text class="member-title">{{memberLevelText}}</text>
          <text class="member-desc">有效期至：{{memberExpireDate}}</text>
        </view>
        <view class="member-benefits">
          <text class="benefit-item">✅ 无限AI对话</text>
          <text class="benefit-item">✅ 专属健康顾问</text>
          <text class="benefit-item">✅ 高级数据分析</text>
        </view>
      </view>
    </view>
  </view>

  <!-- 数据概览 -->
  <view class="stats-section">
    <view class="section-title">
      <text class="title-text">我的数据</text>
    </view>
    <view class="stats-grid">
      <view class="stat-item" bindtap="viewWeightData">
        <text class="stat-number">{{todayStats.weight || '--'}}</text>
        <text class="stat-label">今日体重(kg)</text>
      </view>
      <view class="stat-item" bindtap="viewDietData">
        <text class="stat-number">{{todayStats.calories || '--'}}</text>
        <text class="stat-label">今日热量(kcal)</text>
      </view>
      <view class="stat-item" bindtap="viewExerciseData">
        <text class="stat-number">{{todayStats.exerciseTime || '--'}}</text>
        <text class="stat-label">运动时长(分钟)</text>
      </view>
      <view class="stat-item" bindtap="viewPlanData">
        <text class="stat-number">{{todayStats.planCount || '--'}}</text>
        <text class="stat-label">执行计划</text>
      </view>
    </view>
  </view>

  <!-- 功能菜单 -->
  <view class="menu-section">
    <view class="section-title">
      <text class="title-text">功能服务</text>
    </view>
    
    <!-- 健康管理 -->
    <view class="menu-group">
      <view class="group-title">健康管理</view>
      <view class="menu-list">
        <view class="menu-item" bindtap="goToWeightRecord">
          <view class="menu-icon">
            <image src="/images/icon-weight.png" mode="aspectFit"></image>
          </view>
          <text class="menu-text">体重记录</text>
          <view class="menu-arrow">
            <image src="/images/icon-arrow.png" mode="aspectFit"></image>
          </view>
        </view>
        <view class="menu-item" bindtap="goToDietRecord">
          <view class="menu-icon">
            <image src="/images/icon-diet.png" mode="aspectFit"></image>
          </view>
          <text class="menu-text">饮食记录</text>
          <view class="menu-arrow">
            <image src="/images/icon-arrow.png" mode="aspectFit"></image>
          </view>
        </view>
        <view class="menu-item" bindtap="goToExerciseRecord">
          <view class="menu-icon">
            <image src="/images/icon-exercise.png" mode="aspectFit"></image>
          </view>
          <text class="menu-text">运动记录</text>
          <view class="menu-arrow">
            <image src="/images/icon-arrow.png" mode="aspectFit"></image>
          </view>
        </view>
        <view class="menu-item" bindtap="goToPlanManagement">
          <view class="menu-icon">
            <image src="/images/icon-plan.png" mode="aspectFit"></image>
          </view>
          <text class="menu-text">计划管理</text>
          <view class="menu-arrow">
            <image src="/images/icon-arrow.png" mode="aspectFit"></image>
          </view>
        </view>
      </view>
    </view>

    <!-- 健康顾问 -->
    <view class="menu-group">
      <view class="group-title">健康顾问</view>
      <view class="menu-list">
        <view class="menu-item" bindtap="goToAdvisorList">
          <view class="menu-icon">
            <image src="/images/icon-advisor.png" mode="aspectFit"></image>
          </view>
          <text class="menu-text">健康顾问</text>
          <view class="menu-arrow">
            <image src="/images/icon-arrow.png" mode="aspectFit"></image>
          </view>
        </view>
        <view class="menu-item" bindtap="goToChatHistory">
          <view class="menu-icon">
            <image src="/images/icon-chat.png" mode="aspectFit"></image>
          </view>
          <text class="menu-text">聊天记录</text>
          <view class="menu-arrow">
            <image src="/images/icon-arrow.png" mode="aspectFit"></image>
          </view>
        </view>
        <view class="menu-item" bindtap="goToPlanReview">
          <view class="menu-icon">
            <image src="/images/icon-review.png" mode="aspectFit"></image>
          </view>
          <text class="menu-text">计划审核</text>
          <view class="menu-arrow">
            <image src="/images/icon-arrow.png" mode="aspectFit"></image>
          </view>
        </view>
      </view>
    </view>

    <!-- 会员服务 -->
    <view class="menu-group">
      <view class="group-title">会员服务</view>
      <view class="menu-list">
        <view class="menu-item" bindtap="goToMemberCenter">
          <view class="menu-icon">
            <image src="/images/icon-member.png" mode="aspectFit"></image>
          </view>
          <text class="menu-text">会员中心</text>
          <view class="menu-arrow">
            <image src="/images/icon-arrow.png" mode="aspectFit"></image>
          </view>
        </view>
        <view class="menu-item" bindtap="goToPaymentHistory">
          <view class="menu-icon">
            <image src="/images/icon-payment.png" mode="aspectFit"></image>
          </view>
          <text class="menu-text">支付记录</text>
          <view class="menu-arrow">
            <image src="/images/icon-arrow.png" mode="aspectFit"></image>
          </view>
        </view>
      </view>
    </view>

    <!-- 设置与帮助 -->
    <view class="menu-group">
      <view class="group-title">设置与帮助</view>
      <view class="menu-list">
        <view class="menu-item" bindtap="goToSettings">
          <view class="menu-icon">
            <image src="/images/icon-settings.png" mode="aspectFit"></image>
          </view>
          <text class="menu-text">设置</text>
          <view class="menu-arrow">
            <image src="/images/icon-arrow.png" mode="aspectFit"></image>
          </view>
        </view>
        <view class="menu-item" bindtap="goToNotification">
          <view class="menu-icon">
            <image src="/images/icon-notification.png" mode="aspectFit"></image>
          </view>
          <text class="menu-text">消息通知</text>
          <view class="notification-badge" wx:if="{{unreadCount > 0}}">
            <text class="badge-text">{{unreadCount}}</text>
          </view>
          <view class="menu-arrow">
            <image src="/images/icon-arrow.png" mode="aspectFit"></image>
          </view>
        </view>
        <view class="menu-item" bindtap="goToFeedback">
          <view class="menu-icon">
            <image src="/images/icon-feedback.png" mode="aspectFit"></image>
          </view>
          <text class="menu-text">意见反馈</text>
          <view class="menu-arrow">
            <image src="/images/icon-arrow.png" mode="aspectFit"></image>
          </view>
        </view>
        <view class="menu-item" bindtap="goToAbout">
          <view class="menu-icon">
            <image src="/images/icon-about.png" mode="aspectFit"></image>
          </view>
          <text class="menu-text">关于我们</text>
          <view class="menu-arrow">
            <image src="/images/icon-arrow.png" mode="aspectFit"></image>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- 退出登录 -->
  <view class="logout-section">
    <button class="btn btn-outline btn-full" bindtap="logout">退出登录</button>
  </view>
</view>
